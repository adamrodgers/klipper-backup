# ==================== HOTEND LED STATUS SYSTEM ====================
# Simplified LED status system for single hotend neopixel

[gcode_macro _led_vars]
# LED status colors for different printer states
variable_colors: {
        'ready': {'r': 0.0, 'g': 0.6, 'b': 0.2, 'w': 0.1},      # Green - ready to print
        'busy': {'r': 0.4, 'g': 0.0, 'b': 0.0, 'w': 0.0},       # Red - busy/working
        'heating': {'r': 0.8, 'g': 0.35, 'b': 0.0, 'w': 0.0},   # Orange - heating
        'printing': {'r': 1.0, 'g': 0.0, 'b': 0.0, 'w': 0.0},   # Bright red - printing
        'homing': {'r': 0.0, 'g': 0.6, 'b': 0.2, 'w': 0.0},     # Green - homing
        'leveling': {'r': 0.5, 'g': 0.1, 'b': 0.4, 'w': 0.0},   # Purple - leveling
        'meshing': {'r': 0.2, 'g': 1.0, 'b': 0.0, 'w': 0.0},    # Bright green - meshing
        'cleaning': {'r': 0.0, 'g': 0.02, 'b': 0.5, 'w': 0.0},  # Blue - cleaning
        'error': {'r': 1.0, 'g': 0.0, 'b': 0.0, 'w': 0.0},      # Bright red - error
        'paused': {'r': 1.0, 'g': 1.0, 'b': 0.0, 'w': 0.0},     # Yellow - paused
        'completed': {'r': 0.0, 'g': 1.0, 'b': 0.0, 'w': 0.0},  # Bright green - completed
        'off': {'r': 0.0, 'g': 0.0, 'b': 0.0, 'w': 0.0},        # Off
        'white': {'r': 0.0, 'g': 0.0, 'b': 0.0, 'w': 1.0},      # White light
        'standby': {'r': 0.01, 'g': 0.01, 'b': 0.01, 'w': 0.1}, # Dim white - standby
    }
variable_led_name: "hotend_rgb"  # Your neopixel name
gcode:
    # This section is required. Do Not Delete.

[gcode_macro _set_hotend_led]
gcode:
    {% set red = params.RED|default(0)|float %}
    {% set green = params.GREEN|default(0)|float %}
    {% set blue = params.BLUE|default(0)|float %}
    {% set white = params.WHITE|default(0)|float %}
    {% set led_name = printer["gcode_macro _led_vars"].led_name %}
    
    SET_LED LED={led_name} RED={red} GREEN={green} BLUE={blue} WHITE={white}

[gcode_macro _set_hotend_led_by_name]
gcode:
    {% set color_name = params.COLOR %}
    {% set colors = printer["gcode_macro _led_vars"].colors %}
    {% set color = colors[color_name] %}
    
    _set_hotend_led RED={color.r} GREEN={color.g} BLUE={color.b} WHITE={color.w}

# ==================== LED STATUS MACROS ====================
[gcode_macro status_ready]
gcode:
    _set_hotend_led_by_name COLOR=ready

[gcode_macro status_off]
gcode:
    _set_hotend_led_by_name COLOR=off

[gcode_macro status_busy]
gcode:
    _set_hotend_led_by_name COLOR=busy

[gcode_macro status_heating]
gcode:
    _set_hotend_led_by_name COLOR=heating

[gcode_macro status_printing]
gcode:
    _set_hotend_led_by_name COLOR=printing

[gcode_macro status_homing]
gcode:
    _set_hotend_led_by_name COLOR=homing

[gcode_macro status_leveling]
gcode:
    _set_hotend_led_by_name COLOR=leveling

[gcode_macro status_meshing]
gcode:
    _set_hotend_led_by_name COLOR=meshing

[gcode_macro status_cleaning]
gcode:
    _set_hotend_led_by_name COLOR=cleaning

[gcode_macro status_error]
gcode:
    _set_hotend_led_by_name COLOR=error

[gcode_macro status_paused]
gcode:
    _set_hotend_led_by_name COLOR=paused

[gcode_macro status_completed]
gcode:
    _set_hotend_led_by_name COLOR=completed

[gcode_macro status_white]
gcode:
    _set_hotend_led_by_name COLOR=white

[gcode_macro status_standby]
gcode:
    _set_hotend_led_by_name COLOR=standby

# ==================== ENHANCED HELPER MACROS ====================
[gcode_macro _LOG_STATUS]
description: Consistent status logging with display, console output, and LED status
rename_existing: _LOG_STATUS_BASE
gcode:
    {% set msg = params.MSG|default("Status update")|string %}
    {% set led_status = params.LED|default("")|string %}
    
    # Call original logging
    _LOG_STATUS_BASE MSG="{msg}"
    
    # Set LED status if provided
    {% if led_status != "" %}
        {% if led_status in printer["gcode_macro _led_vars"].colors %}
            _set_hotend_led_by_name COLOR={led_status}
        {% endif %}
    {% endif %}

[gcode_macro _LOG_ERROR]
description: Error logging with display, console output, and error LED
rename_existing: _LOG_ERROR_BASE
gcode:
    {% set msg = params.MSG|default("Error occurred")|string %}
    
    # Call original error logging
    _LOG_ERROR_BASE MSG="{msg}"
    
    # Set error LED status
    status_error